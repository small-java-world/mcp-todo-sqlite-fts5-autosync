# Search（FTS5）の安全設計（契約）

## 1. 演算子ホワイトリスト
- 許容するのは **句検索 `"phrase"`** と **近接 `NEAR/N`** のみ。
- `*`, `:`, `AND/OR/NOT` などの複雑演算子は **無効化**。

## 2. サニタイズ規則
- すべての語句は **強制的に引用** される。
- 無効トークンを検出した場合は `error.code=BAD_QUERY` を返す。

## 3. 対象列の固定
- `MATCH`/`snippet(...)` の対象列は **`title`, `text`** のみ。
- クライアントから列名を指定することはできない（固定）。

## 4. エラー規約
- 無効式: `BAD_QUERY`
- 速度抑制: クエリ長/語数に上限（例: 256bytes/8語）。
- レート制御: 60 req/min（超過時は `RATE_LIMITED`）。